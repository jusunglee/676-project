{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>type</th>\n",
       "      <th>posts</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>INFJ</td>\n",
       "      <td>'http://www.youtube.com/watch?v=qsXHcwe3krw|||...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>ENTP</td>\n",
       "      <td>'I'm finding the lack of me in these posts ver...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>INTP</td>\n",
       "      <td>'Good one  _____   https://www.youtube.com/wat...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>INTJ</td>\n",
       "      <td>'Dear INTP,   I enjoyed our conversation the o...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>ENTJ</td>\n",
       "      <td>'You're fired.|||That's another silly misconce...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8670</td>\n",
       "      <td>ISFP</td>\n",
       "      <td>'https://www.youtube.com/watch?v=t8edHB_h908||...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8671</td>\n",
       "      <td>ENFP</td>\n",
       "      <td>'So...if this thread already exists someplace ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8672</td>\n",
       "      <td>INTP</td>\n",
       "      <td>'So many questions when i do these things.  I ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8673</td>\n",
       "      <td>INFP</td>\n",
       "      <td>'I am very conflicted right now when it comes ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8674</td>\n",
       "      <td>INFP</td>\n",
       "      <td>'It has been too long since I have been on per...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8675 rows Ã— 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      type                                              posts\n",
       "0     INFJ  'http://www.youtube.com/watch?v=qsXHcwe3krw|||...\n",
       "1     ENTP  'I'm finding the lack of me in these posts ver...\n",
       "2     INTP  'Good one  _____   https://www.youtube.com/wat...\n",
       "3     INTJ  'Dear INTP,   I enjoyed our conversation the o...\n",
       "4     ENTJ  'You're fired.|||That's another silly misconce...\n",
       "...    ...                                                ...\n",
       "8670  ISFP  'https://www.youtube.com/watch?v=t8edHB_h908||...\n",
       "8671  ENFP  'So...if this thread already exists someplace ...\n",
       "8672  INTP  'So many questions when i do these things.  I ...\n",
       "8673  INFP  'I am very conflicted right now when it comes ...\n",
       "8674  INFP  'It has been too long since I have been on per...\n",
       "\n",
       "[8675 rows x 2 columns]"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "df = pd.read_csv('mbti_1.csv')\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['absolut', 'adventur', 'agre', 'alcohol', 'ameli', 'amen', 'apart', 'appl', 'arrog', 'ax', 'bark', 'beach', 'bear', 'beast', 'beauti', 'bill', 'bittersweet', 'blind', 'blood', 'blue', 'boob', 'booooo', 'bore', 'both', 'brain', 'bread', 'bump', 'cake', 'canada', 'candi', 'care', 'cereal', 'chao', 'cheap', 'chess', 'christma', 'cider', 'clash', 'clock', 'clown', 'cocain', 'core', 'crack', 'crap', 'crash', 'crate', 'creepi', 'danc', 'dare', 'dart', 'date', 'dear', 'death', 'delet', 'determin', 'dime', 'discuss', 'disregard', 'ditto', 'done', 'doubl', 'doublepost', 'dp', 'dread', 'dream', 'dress', 'drink', 'drug', 'duplic', 'eas', 'eat', 'edit', 'eie', 'eii', 'einstein', 'empathi', 'enfj', 'enfp', 'entj', 'entp', 'enxp', 'epinephrin', 'esfj', 'esfp', 'estj', 'estp', 'everyth', 'exact', 'exactli', 'extra', 'extrovers', 'exxp', 'fals', 'feel', 'ferri', 'fi', 'filet', 'fist', 'fix', 'fleet', 'florida', 'frustrat', 'fuck', 'furi', 'ghostbust', 'glean', 'go', 'grain', 'greed', 'green', 'greet', 'gross', 'gryffindor', 'haha', 'hahaha', 'hahahaha', 'harsh', 'hatch', 'heap', 'heart', 'heat', 'hello', 'hi', 'hufflepuff', 'ignor', 'inde', 'infj', 'infp', 'infx', 'insidi', 'intellig', 'interest', 'intj', 'intp', 'intx', 'inxj', 'inxp', 'isfj', 'isfp', 'istj', 'istp', 'it', 'ixtp', 'kind', 'kite', 'lamb', 'law', 'leer', 'lick', 'life', 'link', 'lmao', 'lmfao', 'lol', 'lost', 'love', 'lover', 'lul', 'make', 'male', 'mango', 'marsh', 'mayb', 'me', 'meal', 'meh', 'melanchol', 'meme', 'mexico', 'money', 'monoton', 'moos', 'myself', 'nah', 'naiv', 'ne', 'neither', 'ni', 'nice', 'no', 'none', 'nope', 'noth', 'nvm', 'ok', 'okay', 'oop', 'ouch', 'owl', 'oxygen', 'pant', 'paranoid', 'part', 'past', 'peac', 'pear', 'perhap', 'perv', 'phase', 'pizza', 'play', 'pose', 'possibl', 'press', 'pride', 'probabl', 'psycholog', 'qft', 'rain', 'raini', 'raspi', 'rate', 'ratio', 'ravenclaw', 'read', 'reap', 'relax', 'remov', 'reserv', 'rider', 'rip', 'robe', 'rose', 'salv', 'same', 'sand', 'sassi', 'scale', 'scuff', 'se', 'seal', 'seed', 'sex', 'shadilay', 'shard', 'share', 'sharp', 'shear', 'sheen', 'sheer', 'short', 'si', 'sky', 'slave', 'sleep', 'slip', 'slytherin', 'smear', 'spare', 'spark', 'spear', 'speed', 'spi', 'sport', 'spunk', 'stale', 'stall', 'star', 'stare', 'start', 'steed', 'steel', 'steep', 'stern', 'stfu', 'stink', 'straw', 'stray', 'sup', 'sure', 'surpris', 'swan', 'sword', 'tail', 'tame', 'tast', 'tasti', 'tater', 'te', 'tear', 'teas', 'test', 'thank', 'theorist', 'thi', 'thick', 'thought', 'ti', 'time', 'tire', 'toad', 'tour', 'trap', 'trash', 'tread', 'tree', 'tru', 'trust', 'truth', 'ugh', 'urin', 'vice', 'wait', 'water', 'welcom', 'well', 'white', 'whore', 'wine', 'woop', 'word', 'work', 'wrap', 'wtf', 'xd', 'xntp', 'xxxx', 'yank', 'ye', 'yea', 'yeah', 'yearn', 'yeast', 'yee', 'yep', 'yesss', 'youtub', 'yup']\n"
     ]
    }
   ],
   "source": [
    "from sklearn.feature_extraction.text import CountVectorizer\n",
    "import nltk\n",
    "from nltk.corpus import stopwords\n",
    "from nltk.stem.porter import *\n",
    "stop_words =  set(stopwords.words('english'))\n",
    "ps = PorterStemmer()\n",
    "\n",
    "def letters_only(word):\n",
    "    for x in word:\n",
    "        if x not in set('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'):\n",
    "            return False\n",
    "    return True\n",
    "\n",
    "\n",
    "def not_stop_word(word):\n",
    "    return word not in stop_words\n",
    "\n",
    "\n",
    "def word_filter(word):\n",
    "    return letters_only(word) and not_stop_word(word)\n",
    "\n",
    "\n",
    "def get_bag_of_words(df, word_column, min_df):\n",
    "    corpus = [' '.join([ps.stem(i) for i in row[word_column].split('|||') if word_filter(i)]) for index, row in df.iterrows()]\n",
    "    vectorizer = CountVectorizer(min_df=min_df)\n",
    "    X = vectorizer.fit_transform(corpus)\n",
    "    return vectorizer.get_feature_names(), X\n",
    "\n",
    "\n",
    "words, bag_of_words = get_bag_of_words(df, 'posts', 2)\n",
    "print(words)\n",
    "\n",
    "['adventur']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.7688772662765296, 0.8616728854729747, 0.5383311009413252, 0.6023060077921112]\n"
     ]
    }
   ],
   "source": [
    "from sklearn.linear_model import LogisticRegression\n",
    "from sklearn.model_selection import KFold\n",
    "import numpy as np\n",
    "\n",
    "y = df['type']\n",
    "df['first_type'] = df['type'].apply(lambda x: x[0])\n",
    "df['second_type'] = df['type'].apply(lambda x: x[1])\n",
    "df['third_type'] = df['type'].apply(lambda x: x[2])\n",
    "df['fourth_type'] = df['type'].apply(lambda x: x[3])\n",
    "\n",
    "def logistic_regression(words, bag_of_words, k):\n",
    "    mean_scores = []\n",
    "    for mbti_type in ['first', 'second', 'third', 'fourth']:\n",
    "        X = pd.DataFrame(bag_of_words.todense(), columns=words)\n",
    "        y = df[mbti_type + '_type']\n",
    "        clf = LogisticRegression(random_state=0, solver='liblinear')\n",
    "        kf = KFold(n_splits=k)\n",
    "        \n",
    "        scores = []\n",
    "        for train_index, test_index in kf.split(X):\n",
    "            X_train, X_test = X.iloc[train_index], X.iloc[test_index]\n",
    "            y_train, y_test = y.iloc[train_index], y.iloc[test_index]\n",
    "            clf.fit(X_train, y_train)\n",
    "            scores += [clf.score(X_test,y_test)]\n",
    "\n",
    "        mean_scores.append(sum(scores) / len(scores))\n",
    "    return mean_scores\n",
    "\n",
    "result = logistic_regression(words, bag_of_words, 10)\n",
    "print(result)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
